{
    # Global options
    email admin@goexec.de
}

# Automatic HTTPS with Let's Encrypt for goexec.de and www.goexec.de
goexec.de, www.goexec.de {
    # Caddy automatically obtains and renews Let's Encrypt certificates
    # No manual TLS configuration needed!

    encode gzip

    # Proxy API requests to the backend
    handle /api/* {
        reverse_proxy api:3000
    }

    # Serve mobile app assets (Expo bundles accessed from /mobile/index.html)
    handle /_expo/* {
        root * /srv/mobile
        try_files {path} =404
        file_server
    }

    # Serve mobile app
    handle_path /mobile/* {
        root * /srv/mobile
        try_files {path} /index.html
        file_server
    }

    # Serve static files from /srv
    handle {
        root * /srv
        try_files {path} /index.html
        file_server
    }
}
